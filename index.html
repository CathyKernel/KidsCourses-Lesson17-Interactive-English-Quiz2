<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LOTW Lesson #A1-17: Prepositions & God's Laws</title>
    <style>
        :root {
            --primary: #4a6fa5;
            --secondary: #166088;
            --accent: #4fc3f7;
            --light: #f8f9fa;
            --dark: #343a40;
            --success: #28a745;
            --warning: #ffc107;
            --danger: #dc3545;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--dark);
            background-color: #f5f7fa;
            margin: 0;
            padding: 0;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: 80vh;
            position: relative;
        }
        
        header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 20px 0;
            text-align: center;
            border-radius: 8px 8px 0 0;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        
        h1, h2, h3 {
            margin: 0;
            font-weight: 600;
        }
        
        h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
        }
        
        h2 {
            color: var(--secondary);
            font-size: 1.8rem;
            margin: 25px 0 15px;
            border-bottom: 2px solid var(--accent);
            padding-bottom: 8px;
        }
        
        h3 {
            font-size: 1.4rem;
            color: var(--primary);
            margin: 20px 0 10px;
        }
        
        .lesson-section {
            background-color: white;
            border-radius: 8px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            position: relative;
        }
        
        .edit-controls {
            position: absolute;
            top: 15px;
            right: 15px;
            display: flex;
            gap: 5px; 
        }
        
        .edit-controls button {
            color: white;
            border: none;
            border-radius: 4px;
            padding: 5px 10px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background-color 0.3s;
            display: flex; 
            align-items: center;
            gap: 5px; 
        }
        .edit-controls button i {
            font-size: 0.8rem; 
        }

        .edit-btn-section { background-color: var(--accent); }
        .edit-btn-section:hover:not(:disabled) { background-color: var(--secondary); }

        .save-btn-section { background-color: var(--success); }
        .save-btn-section:hover:not(:disabled) { background-color: #218838; }

        .cancel-btn-section { background-color: var(--danger); }
        .cancel-btn-section:hover:not(:disabled) { background-color: #c82333; }
        
        .edit-controls button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }

        .hidden {
            display: none !important;
        }
        
        .content-editable {
            min-height: 50px;
            padding: 10px;
            border: 1px dashed transparent;
            transition: all 0.3s;
        }
        
        .content-editable:hover:not([contenteditable="true"]) {
            border-color: var(--accent);
            background-color: rgba(79, 195, 247, 0.05);
        }
        
        .content-editable[contenteditable="true"] {
            outline: none;
            border: 1px solid var(--accent);
            background-color: rgba(79, 195, 247, 0.1);
        }
        
        .image-container {
            text-align: center;
            margin: 20px 0;
            position: relative;
        }
        
        .image-container img {
            max-width: 100%;
            height: auto;
            border-radius: 6px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
            transition: transform 0.3s;
        }
        
        .image-container img:hover {
            transform: scale(1.02);
        }
        
        .upload-btn {
            display: inline-block;
            margin-top: 10px;
            padding: 8px 15px;
            background-color: var(--primary);
            color: white;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s;
        }
        
        .upload-btn:hover {
            background-color: var(--secondary);
        }
        
        .interactive-activity {
            background-color: #e9f7fe;
            border-left: 4px solid var(--accent);
            padding: 20px;
            margin: 25px 0;
            border-radius: 0 6px 6px 0;
        }
        
        .activity-title {
            font-weight: 600;
            color: var(--secondary);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }
        
        .activity-title i {
            margin-right: 10px;
            font-size: 1.2rem;
        }
        
        .drag-drop-container {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin: 20px 0;
        }
        
        .draggable {
            background-color: white;
            border: 2px dashed var(--primary);
            padding: 12px 15px;
            border-radius: 6px;
            cursor: grab;
            font-weight: 500;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: all 0.3s;
        }
        
        .draggable:hover {
            background-color: var(--light);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        
        .dropzone {
            min-height: 100px;
            border: 2px dashed var(--accent);
            border-radius: 8px;
            padding: 15px;
            background-color: rgba(255,255,255,0.7);
            margin: 15px 0;
            transition: all 0.3s;
        }
        
        .dropzone.highlight {
            background-color: rgba(79, 195, 247, 0.2);
            border-color: var(--secondary);
        }
        
        .audio-player {
            width: 100%;
            margin: 15px 0;
        }
        
        .quiz-container {
            margin: 25px 0;
        }
        
        .quiz-question {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .quiz-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }
        
        .quiz-option {
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 10px 15px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .quiz-option:hover {
            background-color: var(--light);
            border-color: var(--accent);
        }
        
        .quiz-option.selected {
            background-color: var(--accent);
            color: white;
            border-color: var(--accent);
        }
        
        .quiz-option.correct {
            background-color: var(--success);
            color: white;
            border-color: var(--success);
        }
        
        .quiz-option.incorrect {
            background-color: var(--danger);
            color: white;
            border-color: var(--danger);
        }
        
        .feedback {
            margin-top: 10px;
            padding: 10px;
            border-radius: 4px;
            display: none;
        }
        
        .feedback.correct {
            background-color: rgba(40, 167, 69, 0.2);
            color: var(--success);
            display: block;
        }
        
        .feedback.incorrect {
            background-color: rgba(220, 53, 69, 0.2);
            color: var(--danger);
            display: block;
        }
        
        .btn {
            display: inline-block;
            padding: 10px 20px;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s;
            text-align: center;
        }
        
        .btn:hover {
            background-color: var(--secondary);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .btn-secondary {
            background-color: #6c757d;
        }
        
        .btn-secondary:hover {
            background-color: #5a6268;
        }
        
        .save-all-btn {
            background-color: var(--success);
            margin-top: 20px;
            padding: 12px 25px;
            font-size: 1.1rem;
        }
        
        .save-all-btn:hover {
            background-color: #218838;
        }
        
        .verse-box {
            background-color: #f8f9fa;
            border-left: 4px solid var(--primary);
            padding: 15px;
            margin: 20px 0;
            font-style: italic;
            position: relative;
        }
        
        .verse-ref {
            text-align: right;
            font-weight: 500;
            color: var(--secondary);
            margin-top: 10px;
        }
        
        .page-navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            padding: 20px 0;
            border-top: 1px solid #ddd;
        }
        
        .page-indicator {
            text-align: center;
            margin: 10px 0;
            font-weight: 500;
            color: var(--secondary);
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px 0;
            color: #6c757d;
            font-size: 0.9rem;
        }
        
        .page { display: none; }
        .page.active { display: block; }
        
        @media (max-width: 768px) {
            .container { padding: 15px; }
            header { padding: 15px 0; }
            h1 { font-size: 1.8rem; }
            .lesson-section { padding: 15px; }
            .quiz-options { grid-template-columns: 1fr; }
            .edit-controls {
                top: 10px; 
                right: 10px;
            }
            .edit-controls button {
                padding: 4px 8px;
                font-size: 0.8rem;
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>LOTW Lesson #A1-17</h1>
            <p>Prepositions of Place & God's Laws</p>
        </header>
        
        <!-- Page 1: Introduction -->
        <div class="page active" id="page1">
            <section class="lesson-section">
                <div class="edit-controls">
                    <button class="edit-btn-section" onclick="enableEdit(this)"><i class="fas fa-edit"></i> Edit</button>
                    <button class="save-btn-section hidden" onclick="saveSectionChanges(this)"><i class="fas fa-save"></i> Save</button>
                    <button class="cancel-btn-section hidden" onclick="cancelSectionChanges(this)"><i class="fas fa-times"></i> Cancel</button>
                </div>
                <h2>Pray, Review, and Preview</h2>
                <div class="content-editable" id="p1-prayer-review" contenteditable="false">
                    <p>Let's begin our lesson with prayer. Dear Lord, thank you for this opportunity to learn English and your Word. Help us to understand your laws and how to use prepositions correctly. Amen.</p>
                </div>
                
                <div class="verse-box">
                    <div class="edit-controls">
                        <button class="edit-btn-section" onclick="enableEdit(this)"><i class="fas fa-edit"></i> Edit</button>
                        <button class="save-btn-section hidden" onclick="saveSectionChanges(this)"><i class="fas fa-save"></i> Save</button>
                        <button class="cancel-btn-section hidden" onclick="cancelSectionChanges(this)"><i class="fas fa-times"></i> Cancel</button>
                    </div>
                    <div class="content-editable" id="p1-versebox-1peter" contenteditable="false">
                        "Be holy in everything you do, just as God is holy. He is the one who chose you." - 1 Peter 1:15 ERV
                    </div>
                </div>
            </section>
            
            <section class="lesson-section">
                <div class="edit-controls">
                    <button class="edit-btn-section" onclick="enableEdit(this)"><i class="fas fa-edit"></i> Edit</button>
                    <button class="save-btn-section hidden" onclick="saveSectionChanges(this)"><i class="fas fa-save"></i> Save</button>
                    <button class="cancel-btn-section hidden" onclick="cancelSectionChanges(this)"><i class="fas fa-times"></i> Cancel</button>
                </div>
                <h2>Today's Learning Objectives</h2>
                <div class="content-editable" id="p1-learning-objectives" contenteditable="false">
                    <p>By the end of this lesson, you will be able to:</p>
                    <ul>
                        <li>Use prepositions of place correctly in sentences</li>
                        <li>Pronounce /L/ and /H/ sounds accurately</li>
                        <li>Understand the story of Moses receiving God's laws</li>
                        <li>Apply God's commandments to daily life</li>
                        <li>Ask and answer questions about locations</li>
                    </ul>
                </div>
            </section>
            
            <div class="page-navigation">
                <button class="btn btn-secondary" disabled><i class="fas fa-arrow-left"></i> Previous</button>
                <button class="btn" onclick="navigateTo(2)">Next <i class="fas fa-arrow-right"></i></button>
            </div>
            <div class="page-indicator">Page 1 of 6</div>
        </div>
        
        <!-- Page 2: Bible Reading -->
        <div class="page" id="page2">
            <section class="lesson-section">
                <div class="edit-controls">
                    <button class="edit-btn-section" onclick="enableEdit(this)"><i class="fas fa-edit"></i> Edit</button>
                    <button class="save-btn-section hidden" onclick="saveSectionChanges(this)"><i class="fas fa-save"></i> Save</button>
                    <button class="cancel-btn-section hidden" onclick="cancelSectionChanges(this)"><i class="fas fa-times"></i> Cancel</button>
                </div>
                <h2>Bible Reading: Moses Gives God's Laws</h2>
                <div class="content-editable" id="p2-bible-reading-main" contenteditable="false">
                    <p>Today we'll read from Exodus 3:9-12; 5:1-11; 12:21-42; 20:1-17</p>
                    <p><strong>Theme:</strong> Where is it?</p>
                </div>
                
                <div class="image-container">
                    <img src="https://freebibleimages.org/slides/moses/moses-10-commandments-1.jpg" alt="Moses with the Ten Commandments" id="bible-story-img">
                    <div>
                        <button class="upload-btn" onclick="document.getElementById('image-upload-page2').click()"><i class="fas fa-upload"></i> Change Image</button>
                        <input type="file" id="image-upload-page2" accept="image/*" style="display: none;" onchange="previewImage(event, 'bible-story-img')">
                    </div>
                </div>
            </section>
            
            <section class="lesson-section">
                <div class="edit-controls">
                    <button class="edit-btn-section" onclick="enableEdit(this)"><i class="fas fa-edit"></i> Edit</button>
                    <button class="save-btn-section hidden" onclick="saveSectionChanges(this)"><i class="fas fa-save"></i> Save</button>
                    <button class="cancel-btn-section hidden" onclick="cancelSectionChanges(this)"><i class="fas fa-times"></i> Cancel</button>
                </div>
                <h2>Bible Story Summary</h2>
                <div class="content-editable" id="p2-bible-story-summary" contenteditable="false">
                    <p>Four hundred thirty (430) years passed. God's people grew in number. The new king of Egypt made them his slaves and was not kind to them.</p>
                    <p>Then God sent Moses to bring his people out of Egypt. Moses did many miracles to set them free. Moses led the people to a mountain.</p>
                    <p>God loved the people he made. He wanted them to live good, holy lives. So he gave them some laws. These laws help people to live the way God wants.</p>
                </div>
            </section>
            
            <div class="page-navigation">
                <button class="btn btn-secondary" onclick="navigateTo(1)"><i class="fas fa-arrow-left"></i> Previous</button>
                <button class="btn" onclick="navigateTo(3)">Next <i class="fas fa-arrow-right"></i></button>
            </div>
            <div class="page-indicator">Page 2 of 6</div>
        </div>
        
        <!-- Page 3: Pronunciation and Grammar -->
        <div class="page" id="page3">
            <section class="lesson-section">
                <div class="edit-controls">
                    <button class="edit-btn-section" onclick="enableEdit(this)"><i class="fas fa-edit"></i> Edit</button>
                    <button class="save-btn-section hidden" onclick="saveSectionChanges(this)"><i class="fas fa-save"></i> Save</button>
                    <button class="cancel-btn-section hidden" onclick="cancelSectionChanges(this)"><i class="fas fa-times"></i> Cancel</button>
                </div>
                <h2>Pronunciation Practice: /L/ and /H/ Sounds</h2>
                <div class="content-editable" id="p3-pronunciation-practice" contenteditable="false">
                    <p>Let's practice these sounds that appear in our prepositions:</p>
                    <ul>
                        <li><strong>/L/ sound:</strong> love, law, Lord, lead, holy</li>
                        <li><strong>/H/ sound:</strong> help, have, hundred, house, home</li>
                    </ul>
                </div>
                
                <div class="interactive-activity">
                    <div class="activity-title"><i class="fas fa-volume-up"></i> Listen and Repeat</div>
                    <audio controls class="audio-player" id="pronunciation-audio">
                        <source src="audio/pronunciation.mp3" type="audio/mpeg">
                        Your browser does not support the audio element.
                    </audio>
                    <button class="upload-btn" onclick="document.getElementById('audio-upload-page3').click()"><i class="fas fa-upload"></i> Change Audio</button>
                    <input type="file" id="audio-upload-page3" accept="audio/*" style="display: none;" onchange="previewAudio(event, 'pronunciation-audio')">
                    
                    <!-- This content-editable is part of an activity. If it needs its own edit controls, they'd be placed here.
                         Otherwise, the section's edit controls target "p3-pronunciation-practice".
                         For simplicity, we'll assume the section's controls are for the main text above.
                         If you want to edit this specific part, you'd add another <div class="edit-controls"> here. -->
                    <div class="content-editable" id="p3-listen-repeat-instructions" contenteditable="false"> 
                        <p>Repeat after the audio:</p>
                        <ol>
                            <li>The Lord loves and helps us.</li>
                            <li>He helps us have holy lives.</li>
                            <li>Moses led the people to the holy land.</li>
                        </ol>
                    </div>
                </div>
            </section>
            
            <section class="lesson-section">
                <div class="edit-controls">
                    <button class="edit-btn-section" onclick="enableEdit(this)"><i class="fas fa-edit"></i> Edit</button>
                    <button class="save-btn-section hidden" onclick="saveSectionChanges(this)"><i class="fas fa-save"></i> Save</button>
                    <button class="cancel-btn-section hidden" onclick="cancelSectionChanges(this)"><i class="fas fa-times"></i> Cancel</button>
                </div>
                <h2>Grammar: Prepositions of Place</h2>
                <div class="content-editable" id="p3-grammar-prepositions" contenteditable="false">
                    <p>Prepositions tell us <strong>where</strong> something is. Today we'll practice:</p>
                    <ul>
                        <li>in, on, at</li>
                        <li>above, below, under</li>
                        <li>beside, between, behind</li>
                        <li>around, across</li>
                    </ul>
                </div>
            </section>
            
            <div class="page-navigation">
                <button class="btn btn-secondary" onclick="navigateTo(2)"><i class="fas fa-arrow-left"></i> Previous</button>
                <button class="btn" onclick="navigateTo(4)">Next <i class="fas fa-arrow-right"></i></button>
            </div>
            <div class="page-indicator">Page 3 of 6</div>
        </div>
        
        <!-- Page 4: Interactive Practice -->
        <div class="page" id="page4">
            <section class="lesson-section">
                <div class="edit-controls">
                    <button class="edit-btn-section" onclick="enableEdit(this)"><i class="fas fa-edit"></i> Edit</button>
                    <button class="save-btn-section hidden" onclick="saveSectionChanges(this)"><i class="fas fa-save"></i> Save</button>
                    <button class="cancel-btn-section hidden" onclick="cancelSectionChanges(this)"><i class="fas fa-times"></i> Cancel</button>
                </div>
                <h2>Interactive Practice: Where Is It?</h2>
                <!-- The section's edit button will target p4-quiz-instructions as it's the first .content-editable for the instructions -->
                <div class="interactive-activity">
                    <div class="activity-title"><i class="fas fa-eye"></i> What Do You See?</div>
                    <div class="image-container">
                        <img src="https://freebibleimages.org/slides/parables/parable-good-samaritan-03.jpg" alt="Park scene for prepositions practice" id="preposition-practice-img">
                        <button class="upload-btn" onclick="document.getElementById('image-upload-page4').click()"><i class="fas fa-upload"></i> Change Image</button>
                        <input type="file" id="image-upload-page4" accept="image/*" style="display: none;" onchange="previewImage(event, 'preposition-practice-img')">
                    </div>
                    
                    <div class="quiz-container">
                        <div class="quiz-question">
                            <div class="content-editable" id="p4-quiz-instructions" contenteditable="false">
                                <p>Complete the sentences about the picture:</p>
                            </div>
                            <ol>
                                <li>The people are <select class="preposition-select">
                                    <option value="">Choose...</option>
                                    <option value="at">at</option>
                                    <option value="in">in</option>
                                    <option value="on">on</option>
                                </select> the park. <span class="feedback-text"></span></li>
                                <li>The tree is <select class="preposition-select">
                                    <option value="">Choose...</option>
                                    <option value="behind">behind</option>
                                    <option value="in front of">in front of</option>
                                    <option value="beside">beside</option>
                                </select> the woman. <span class="feedback-text"></span></li>
                                <li>The bread is <select class="preposition-select">
                                    <option value="">Choose...</option>
                                    <option value="in">in</option>
                                    <option value="on">on</option>
                                    <option value="under">under</option>
                                </select> the basket. <span class="feedback-text"></span></li>
                            </ol>
                            <button class="btn" onclick="checkPrepositions()">Check Answers</button>
                        </div>
                    </div>
                </div>
            </section>
            
            <div class="page-navigation">
                <button class="btn btn-secondary" onclick="navigateTo(3)"><i class="fas fa-arrow-left"></i> Previous</button>
                <button class="btn" onclick="navigateTo(5)">Next <i class="fas fa-arrow-right"></i></button>
            </div>
            <div class="page-indicator">Page 4 of 6</div>
        </div>
        
        <!-- Page 5: Drag and Drop Activity -->
        <div class="page" id="page5">
            <section class="lesson-section">
                <div class="edit-controls">
                    <button class="edit-btn-section" onclick="enableEdit(this)"><i class="fas fa-edit"></i> Edit</button>
                    <button class="save-btn-section hidden" onclick="saveSectionChanges(this)"><i class="fas fa-save"></i> Save</button>
                    <button class="cancel-btn-section hidden" onclick="cancelSectionChanges(this)"><i class="fas fa-times"></i> Cancel</button>
                </div>
                <h2>Drag and Drop Prepositions</h2>
                 <div class="content-editable" id="p5-drag-drop-instructions" contenteditable="false">
                    <p>Drag the prepositions to complete the sentences:</p>
                </div>
                <div class="interactive-activity">
                    <div class="activity-title"><i class="fas fa-arrows-alt"></i> Drag the Prepositions</div>
                    
                    <div class="drag-drop-container">
                        <div class="draggable" draggable="true" data-word="on">on</div>
                        <div class="draggable" draggable="true" data-word="behind">behind</div>
                        <div class="draggable" draggable="true" data-word="above">above</div>
                        <div class="draggable" draggable="true" data-word="at">at</div>
                        <div class="draggable" draggable="true" data-word="beside">beside</div>
                        <div class="draggable" draggable="true" data-word="in">in</div>
                    </div>
                    
                    <div class="dropzone" id="dropzone-1" data-correct="on">
                        <p>1. The food is <span class="drop-target"></span> the blanket.</p>
                    </div>
                    <div class="dropzone" id="dropzone-2" data-correct="behind">
                        <p>2. The tree is <span class="drop-target"></span> the woman.</p>
                    </div>
                    <div class="dropzone" id="dropzone-3" data-correct="above">
                        <p>3. The sun is <span class="drop-target"></span> the land.</p>
                    </div>
                     <div class="dropzone" id="dropzone-4" data-correct="at">
                        <p>4. The people are <span class="drop-target"></span> the park.</p>
                    </div>
                    <div class="dropzone" id="dropzone-5" data-correct="beside">
                        <p>5. The dog is <span class="drop-target"></span> the man.</p>
                    </div>
                    <div class="dropzone" id="dropzone-6" data-correct="in">
                        <p>6. The bread is <span class="drop-target"></span> the basket.</p>
                    </div>
                    
                    <button class="btn" onclick="checkDragDrop()">Check Answers</button>
                    <button class="btn btn-secondary" onclick="resetDragDrop()">Reset</button>
                </div>
            </section>
            
            <div class="page-navigation">
                <button class="btn btn-secondary" onclick="navigateTo(4)"><i class="fas fa-arrow-left"></i> Previous</button>
                <button class="btn" onclick="navigateTo(6)">Next <i class="fas fa-arrow-right"></i></button>
            </div>
            <div class="page-indicator">Page 5 of 6</div>
        </div>
        
        <!-- Page 6: Vocabulary and Conclusion -->
        <div class="page" id="page6">
            <section class="lesson-section">
                <div class="edit-controls">
                    <button class="edit-btn-section" onclick="enableEdit(this)"><i class="fas fa-edit"></i> Edit</button>
                    <button class="save-btn-section hidden" onclick="saveSectionChanges(this)"><i class="fas fa-save"></i> Save</button>
                    <button class="cancel-btn-section hidden" onclick="cancelSectionChanges(this)"><i class="fas fa-times"></i> Cancel</button>
                </div>
                <h2>Vocabulary Review</h2>
                <div class="content-editable" id="p6-vocab-review-instructions" contenteditable="false">
                    <p>Listen and write these words:</p>
                </div>
                
                <div class="interactive-activity">
                    <div class="activity-title"><i class="fas fa-headphones"></i> Listen and Write</div>
                    <audio controls class="audio-player" id="vocabulary-audio">
                        <source src="audio/vocabulary.mp3" type="audio/mpeg">
                        Your browser does not support the audio element.
                    </audio>
                    <button class="upload-btn" onclick="document.getElementById('audio-upload-page6').click()"><i class="fas fa-upload"></i> Change Audio</button>
                    <input type="file" id="audio-upload-page6" accept="audio/*" style="display: none;" onchange="previewAudio(event, 'vocabulary-audio')">
                    
                    <div class="quiz-container">
                        <div class="quiz-question">
                             <!-- This content-editable is part of an activity. If it needs its own edit controls, they'd be placed here.
                                  Otherwise, the section's edit controls target "p6-vocab-review-instructions". -->
                            <div class="content-editable" id="p6-listen-write-instructions" contenteditable="false">
                                <p>Write one word per line as you hear them:</p>
                            </div>
                            <div id="vocab-words" style="column-count: 2; column-gap: 30px;">
                                <div style="break-inside: avoid;">
                                    <input type="text" class="vocab-input" style="width: 100%; margin-bottom: 10px; padding: 8px;"><span class="feedback-text"></span><br>
                                    <input type="text" class="vocab-input" style="width: 100%; margin-bottom: 10px; padding: 8px;"><span class="feedback-text"></span><br>
                                    <input type="text" class="vocab-input" style="width: 100%; margin-bottom: 10px; padding: 8px;"><span class="feedback-text"></span><br>
                                    <input type="text" class="vocab-input" style="width: 100%; margin-bottom: 10px; padding: 8px;"><span class="feedback-text"></span><br>
                                    <input type="text" class="vocab-input" style="width: 100%; margin-bottom: 10px; padding: 8px;"><span class="feedback-text"></span><br>
                                    <input type="text" class="vocab-input" style="width: 100%; margin-bottom: 10px; padding: 8px;"><span class="feedback-text"></span><br>
                                </div>
                                <div style="break-inside: avoid;">
                                    <input type="text" class="vocab-input" style="width: 100%; margin-bottom: 10px; padding: 8px;"><span class="feedback-text"></span><br>
                                    <input type="text" class="vocab-input" style="width: 100%; margin-bottom: 10px; padding: 8px;"><span class="feedback-text"></span><br>
                                    <input type="text" class="vocab-input" style="width: 100%; margin-bottom: 10px; padding: 8px;"><span class="feedback-text"></span><br>
                                    <input type="text" class="vocab-input" style="width: 100%; margin-bottom: 10px; padding: 8px;"><span class="feedback-text"></span><br>
                                    <input type="text" class="vocab-input" style="width: 100%; margin-bottom: 10px; padding: 8px;"><span class="feedback-text"></span><br>
                                    <input type="text" class="vocab-input" style="width: 100%; margin-bottom: 10px; padding: 8px;"><span class="feedback-text"></span><br>
                                </div>
                            </div>
                            <button class="btn" onclick="showVocabAnswers()">Show Answers</button>
                             <button class="btn btn-secondary" onclick="resetVocab()">Reset</button>
                        </div>
                    </div>
                </div>
            </section>
            
            <section class="lesson-section">
                <div class="edit-controls">
                    <button class="edit-btn-section" onclick="enableEdit(this)"><i class="fas fa-edit"></i> Edit</button>
                    <button class="save-btn-section hidden" onclick="saveSectionChanges(this)"><i class="fas fa-save"></i> Save</button>
                    <button class="cancel-btn-section hidden" onclick="cancelSectionChanges(this)"><i class="fas fa-times"></i> Cancel</button>
                </div>
                <h2>Lesson Summary</h2>
                <div class="content-editable" id="p6-lesson-summary" contenteditable="false">
                    <p>Today we learned:</p>
                    <ul>
                        <li>How to use prepositions of place correctly</li>
                        <li>The story of Moses receiving God's laws</li>
                        <li>How God wants us to live holy lives</li>
                        <li>Important vocabulary about locations</li>
                    </ul>
                </div>
                
                <div class="verse-box">
                    <div class="edit-controls">
                        <button class="edit-btn-section" onclick="enableEdit(this)"><i class="fas fa-edit"></i> Edit</button>
                        <button class="save-btn-section hidden" onclick="saveSectionChanges(this)"><i class="fas fa-save"></i> Save</button>
                        <button class="cancel-btn-section hidden" onclick="cancelSectionChanges(this)"><i class="fas fa-times"></i> Cancel</button>
                    </div>
                    <div class="content-editable" id="p6-versebox-psalm" contenteditable="false">
                        "His love for his followers is as high above us as heaven is above the earth." - Psalm 103:11 ERV
                    </div>
                </div>
            </section>
            
            <div class="text-center">
                <button class="btn save-all-btn" onclick="saveAllChanges()"><i class="fas fa-save"></i> Save All Changes</button>
            </div>
            
            <div class="page-navigation">
                <button class="btn btn-secondary" onclick="navigateTo(5)"><i class="fas fa-arrow-left"></i> Previous</button>
                <button class="btn" disabled>Next <i class="fas fa-arrow-right"></i></button>
            </div>
            <div class="page-indicator">Page 6 of 6</div>
        </div>
        
        <footer>
            <p>©2020-2021 Literacy International - Light of the World Program</p>
        </footer>
    </div>

    <script>
        // Navigation between pages
        let currentPage = 1;
        const totalPages = 6;
        
        function navigateTo(pageNumber) {
            if (pageNumber < 1 || pageNumber > totalPages) return;
            
            const currentPageElement = document.getElementById(`page${currentPage}`);
            const nextPageElement = document.getElementById(`page${pageNumber}`);

            if (currentPageElement) currentPageElement.classList.remove('active');
            if (nextPageElement) nextPageElement.classList.add('active');
            
            currentPage = pageNumber;
            
            document.querySelectorAll('.page-indicator').forEach(indicator => {
                indicator.textContent = `Page ${currentPage} of ${totalPages}`;
            });
            
            window.scrollTo(0, 0);
        }

        // --- NEW EDITING FUNCTIONS ---
        function enableEdit(editBtn) {
            const controlsContainer = editBtn.parentElement;
            const section = controlsContainer.closest('.lesson-section') || controlsContainer.closest('.verse-box');
            
            if (!section) {
                console.error("Edit button's control container is not within a .lesson-section or .verse-box.", controlsContainer);
                return;
            }
            
            const editable = section.querySelector('.content-editable'); 
            if (!editable) {
                console.warn("No .content-editable element found in this section.", section);
                controlsContainer.querySelectorAll('button').forEach(b => b.disabled = true);
                if(editBtn) editBtn.innerHTML = '<i class="fas fa-eye-slash"></i> No Edit Area';
                return;
            }

            editable.setAttribute('data-original-content', editable.innerHTML);
            editable.setAttribute('contenteditable', 'true');
            editable.focus();

            const saveBtn = controlsContainer.querySelector('.save-btn-section');
            const cancelBtn = controlsContainer.querySelector('.cancel-btn-section');

            if(editBtn) editBtn.classList.add('hidden');
            if (saveBtn) saveBtn.classList.remove('hidden');
            if (cancelBtn) cancelBtn.classList.remove('hidden');
        }

        function saveSectionChanges(saveBtn) {
            const controlsContainer = saveBtn.parentElement;
            const section = controlsContainer.closest('.lesson-section') || controlsContainer.closest('.verse-box');
            
            if (!section) return;
            const editable = section.querySelector('.content-editable');
            if (!editable) return;

            editable.setAttribute('contenteditable', 'false');
            editable.removeAttribute('data-original-content'); 

            console.log(`Section content for '${editable.id || 'unknown_section'}' saved:`, editable.innerHTML);

            const editBtn = controlsContainer.querySelector('.edit-btn-section');
            const cancelBtn = controlsContainer.querySelector('.cancel-btn-section');

            if(saveBtn) saveBtn.classList.add('hidden');
            if (cancelBtn) cancelBtn.classList.add('hidden');
            if (editBtn) editBtn.classList.remove('hidden');
        }

        function cancelSectionChanges(cancelBtn) {
            const controlsContainer = cancelBtn.parentElement;
            const section = controlsContainer.closest('.lesson-section') || controlsContainer.closest('.verse-box');

            if (!section) return;
            const editable = section.querySelector('.content-editable');
            if (!editable) return;

            const originalContent = editable.getAttribute('data-original-content');
            if (originalContent !== null) {
                editable.innerHTML = originalContent;
            }
            editable.setAttribute('contenteditable', 'false');
            editable.removeAttribute('data-original-content');

            const editBtn = controlsContainer.querySelector('.edit-btn-section');
            const saveBtn = controlsContainer.querySelector('.save-btn-section');

            if(cancelBtn) cancelBtn.classList.add('hidden');
            if (saveBtn) saveBtn.classList.add('hidden');
            if (editBtn) editBtn.classList.remove('hidden');
        }
        
        // Preview uploaded image
        function previewImage(event, imgId) {
            const reader = new FileReader();
            const output = document.getElementById(imgId);
            if (!output) {
                console.error("Image element not found:", imgId);
                return;
            }
            reader.onload = function(){
                output.src = reader.result;
            };
            if (event.target.files && event.target.files[0]) {
                reader.readAsDataURL(event.target.files[0]);
            }
        }

        // Preview uploaded audio
        function previewAudio(event, audioId) {
            const reader = new FileReader();
            const audioPlayer = document.getElementById(audioId);
             if (!audioPlayer) {
                console.error("Audio player element not found:", audioId);
                return;
            }
            reader.onload = function(e) {
                audioPlayer.src = e.target.result;
                audioPlayer.load();
            };
            if (event.target.files && event.target.files[0]) {
                reader.readAsDataURL(event.target.files[0]);
            }
        }
        
        // Drag and drop functionality
        let draggedItem = null;
        
        document.addEventListener('DOMContentLoaded', function() {
            const draggables = document.querySelectorAll('.draggable');
            const dropTargets = document.querySelectorAll('.drop-target');
            
            draggables.forEach(draggable => {
                draggable.addEventListener('dragstart', function() {
                    draggedItem = this;
                    setTimeout(() => { if(this) this.style.opacity = '0.4'; }, 0);
                });
                
                draggable.addEventListener('dragend', function() {
                    if(this) this.style.opacity = '1';
                    draggedItem = null;
                });
            });
            
            dropTargets.forEach(target => {
                target.addEventListener('dragover', function(e) {
                    e.preventDefault(); 
                    const dropzone = this.closest('.dropzone');
                    if(dropzone) dropzone.classList.add('highlight');
                });
                
                target.addEventListener('dragleave', function() {
                    const dropzone = this.closest('.dropzone');
                    if(dropzone) dropzone.classList.remove('highlight');
                });
                
                target.addEventListener('drop', function(e) {
                    e.preventDefault();
                    const dropzone = this.closest('.dropzone');
                    if(dropzone) dropzone.classList.remove('highlight');
                    
                    if (draggedItem) {
                        this.innerHTML = '';
                        this.style.color = '';
                        this.style.fontWeight = '';
                        this.textContent = draggedItem.textContent;
                        this.setAttribute('data-answer', draggedItem.getAttribute('data-word'));
                    }
                });
            });
        });
        
        function checkDragDrop() {
            const dropzones = document.querySelectorAll('.dropzone');
            let allCorrect = true;
            
            dropzones.forEach(zone => {
                const target = zone.querySelector('.drop-target');
                if (!target) return;

                const userAnswer = target.getAttribute('data-answer');
                const correctAnswer = zone.getAttribute('data-correct');
                
                const feedbackSpanOld = zone.querySelector('.feedback-text-dd');
                if (feedbackSpanOld) feedbackSpanOld.remove();

                if (userAnswer === correctAnswer) {
                    target.style.color = 'var(--success)';
                    target.style.fontWeight = 'bold';
                } else {
                    target.style.color = 'var(--danger)';
                    target.style.fontWeight = 'normal';
                    allCorrect = false;
                    
                    const feedback = document.createElement('span');
                    feedback.classList.add('feedback-text-dd'); 
                    feedback.style.color = 'var(--danger)';
                    feedback.style.marginLeft = '10px';
                    if (userAnswer) {
                        feedback.textContent = `(Incorrect. Correct: ${correctAnswer})`;
                    } else {
                        feedback.textContent = `(Missing. Correct: ${correctAnswer})`;
                    }
                    target.parentNode.appendChild(feedback);
                }
            });
            
            if (allCorrect) {
                alert('Great job! All drag and drop answers are correct!');
            } else {
                alert('Some answers are incorrect or missing. Please review.');
            }
        }
        
        function resetDragDrop() {
            const dropTargets = document.querySelectorAll('.drop-target');
            dropTargets.forEach(target => {
                target.innerHTML = '';
                target.style.color = '';
                target.style.fontWeight = '';
                target.removeAttribute('data-answer');
                const feedbackSpan = target.parentNode.querySelector('.feedback-text-dd');
                if (feedbackSpan) feedbackSpan.remove();
            });
        }
        
        function checkPrepositions() {
            const selects = document.querySelectorAll('.preposition-select');
            const correctAnswers = ['at', 'behind', 'in']; 
            let allCorrect = true;
            
            selects.forEach((select, index) => {
                const feedbackSpan = select.parentElement.querySelector('.feedback-text');
                if (!feedbackSpan) return;
                feedbackSpan.textContent = '';

                if (select.value === correctAnswers[index]) {
                    select.style.backgroundColor = 'rgba(40, 167, 69, 0.1)';
                    select.style.borderColor = 'var(--success)';
                    feedbackSpan.textContent = ' Correct!';
                    feedbackSpan.style.color = 'var(--success)';
                } else {
                    select.style.backgroundColor = 'rgba(220, 53, 69, 0.1)';
                    select.style.borderColor = 'var(--danger)';
                    allCorrect = false;
                    feedbackSpan.textContent = ` Incorrect. (Correct: ${correctAnswers[index]})`;
                    feedbackSpan.style.color = 'var(--danger)';
                }
            });
            
            if (allCorrect) {
                alert('Excellent! All your preposition answers are correct!');
            } else {
                 alert('Some preposition answers are incorrect. Please review.');
            }
        }
        
        function showVocabAnswers() {
            const correctWords = [
                'laws', 'between', 'under', 
                'around', 'below', 'across', 
                'above', 'land', 'help', 
                'have', 'Lord', 'love'
            ]; 
            
            const inputs = document.querySelectorAll('.vocab-input');
            let allCorrect = true;

            inputs.forEach((input, index) => {
                const feedbackSpan = input.nextElementSibling; 
                if (!feedbackSpan) return;
                feedbackSpan.textContent = ''; 
                input.style.backgroundColor = ''; 
                input.style.borderColor = '#ddd';

                if (index < correctWords.length) {
                    const userAnswer = input.value.trim().toLowerCase();
                    const correctAnswer = correctWords[index].toLowerCase();
                    
                    if (userAnswer === correctAnswer) {
                        input.style.backgroundColor = 'rgba(40, 167, 69, 0.1)';
                        input.style.borderColor = 'var(--success)';
                        feedbackSpan.textContent = ' Correct!';
                        feedbackSpan.style.color = 'var(--success)';
                    } else {
                        input.style.backgroundColor = 'rgba(220, 53, 69, 0.1)';
                        input.style.borderColor = 'var(--danger)';
                        feedbackSpan.textContent = ` Incorrect. (Answer: ${correctWords[index]})`;
                        feedbackSpan.style.color = 'var(--danger)';
                        allCorrect = false;
                    }
                } else {
                    input.disabled = true; 
                }
            });

            if(allCorrect && inputs.length >= correctWords.length) {
                alert("Great job! All vocabulary words are correct!");
            } else if (!allCorrect) {
                alert("Some vocabulary words are incorrect. The correct answers are now shown.");
            }
        }

        function resetVocab() {
            const inputs = document.querySelectorAll('.vocab-input');
            inputs.forEach(input => {
                input.value = '';
                input.style.backgroundColor = '';
                input.style.borderColor = '#ddd';
                input.disabled = false;
                const feedbackSpan = input.nextElementSibling;
                if (feedbackSpan && feedbackSpan.classList.contains('feedback-text')) {
                    feedbackSpan.textContent = '';
                }
            });
        }

        function saveAllChanges() {
            const allEditableContent = {};
            
            document.querySelectorAll('.content-editable').forEach(el => {
                 if (el.id) { 
                    allEditableContent[el.id] = el.innerHTML;
                 } else {
                    console.warn("Editable element found without an ID. Skipping save for this element:", el);
                 }
            });
            
            console.log("Saving ALL content:", allEditableContent);
            alert(`All content from ${Object.keys(allEditableContent).length} identified editable regions has been logged to the console. Individual section edit states are not affected by this global save.`);
        }

        document.addEventListener('DOMContentLoaded', () => {
            const imageUploads = [
                { inputId: 'image-upload-page2', imgId: 'bible-story-img' },
                { inputId: 'image-upload-page4', imgId: 'preposition-practice-img' }
            ];
            imageUploads.forEach(upload => {
                const inputElement = document.getElementById(upload.inputId);
                if (inputElement) {
                    inputElement.onchange = (event) => previewImage(event, upload.imgId);
                } else {
                    // console.warn(`Image input element not found: ${upload.inputId}`);
                }
            });

            const audioUploads = [
                { inputId: 'audio-upload-page3', audioId: 'pronunciation-audio' },
                { inputId: 'audio-upload-page6', audioId: 'vocabulary-audio' }
            ];
            audioUploads.forEach(upload => {
                const inputElement = document.getElementById(upload.inputId);
                if (inputElement) {
                    inputElement.onchange = (event) => previewAudio(event, upload.audioId);
                } else {
                    // console.warn(`Audio input element not found: ${upload.inputId}`);
                }
            });
        });
    </script>
</body>
</html>
